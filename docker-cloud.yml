web:
  image: plnfingudelar/clasificahumor
  environment:
    - FLASK_SECRET_KEY
    - MYSQL_ROOT_PASSWORD
    - DB_HOST=database
    - DB_USER=root
    - DB_NAME=pghumor
    #,classifyhumor.com,www.classifyhumor.com as well:
#    - VIRTUAL_HOST=clasificahumor.com,www.clasificahumor.com # After it's bought.
#    #,classifyhumor.com,www.classifyhumor.com as well:
#    - LETSENCRYPT_HOST=clasificahumor.com,www.clasificahumor.com
#    - LETSENCRYPT_EMAIL=sacastro@fing.edu.uy
  links:
    - database
  restart: always
database:
  image: mysql:8
  environment:
    - MYSQL_ROOT_PASSWORD
  volumes:
    - /var/lib/mysql
  restart: always
lb:
  image: dockercloud/haproxy
  ports:
    - '80:80'
  roles:
    - global
  links:
    - web
#nginx-proxy:
#  image: jwilder/nginx-proxy
#  labels:
#    com.github.jrcs.letsencrypt_nginx_proxy_companion.nginx_proxy: "true"
#  ports:
#    - '80:80'
#    - '443:443'
#  volumes:
#    - /etc/nginx/certs # :ro
#    - /etc/nginx/vhost.d
#    - /usr/share/nginx/html
#    - /var/run/docker.sock:/tmp/docker.sock:ro
#  restart: always
#letsencrypt:
#  image: jrcs/letsencrypt-nginx-proxy-companion
#  volumes_from:
#    - nginx-proxy
#  restart: always
